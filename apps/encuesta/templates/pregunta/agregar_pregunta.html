{% extends "encuestaHome.html" %}
{% block title %}
Agregar Pregunta
{% endblock title %}
{% block encuesta %}
<div class="card-header">
    <em class="">Detalle encuesta/preguntas/agregar pregunta/</em>
</div>
<div class="card card-body bg-light mt-2 p-4">
    
    <h5>Agregar pregunta</h5>
    <form method="POST" id="tipo-pregunta-form" onsubmit="return validateForm();">
        {% csrf_token %}
        {{ form.as_p }}
        
        <!-- Contenedor para las opciones múltiples -->
        <div id="opciones-container" style="display: none;">
            <h5>Agregar Opciones</h5>
            <div class="form-group">
                <label for="opcion_1">Opción 1</label>
                <input type="text" class="form-control" id="opcion_1" name="opcion_1">
            </div>
            <div class="form-group">
                <label for="opcion_2">Opción 2</label>
                <input type="text" class="form-control" id="opcion_2" name="opcion_2">
            </div>
            <div class="form-group">
                <label for="opcion_3">Opción 3</label>
                <input type="text" class="form-control" id="opcion_3" name="opcion_3">
            </div>
            <div class="form-group">
                <label for="opcion_4">Opción 4</label>
                <input type="text" class="form-control" id="opcion_4" name="opcion_4">
            </div>
        </div>

        <button class="btn btn-dark mt-2" type="submit">Agregar</button>
    </form>
    <hr>
    
</div>

<script>
    // Mostrar el contenedor de opciones si se selecciona "Selección múltiple"
    document.getElementById("id_tipoPregunta").addEventListener("change", function() {
        if (this.value === "4") {  // Ajusta según el valor de "Selección múltiple"
            document.getElementById("opciones-container").style.display = "block";
        } else {
            document.getElementById("opciones-container").style.display = "none";
        }
    });

    // Validar que las opciones no estén vacías antes de enviar el formulario
    function validateForm() {
        const tipoPregunta = document.getElementById("id_tipoPregunta").value;
        if (tipoPregunta === "4") {  // Ajusta según tu choice para selección múltiple
            const opcion1 = document.getElementById("opcion_1").value.trim();
            const opcion2 = document.getElementById("opcion_2").value.trim();
            const opcion3 = document.getElementById("opcion_3").value.trim();
            const opcion4 = document.getElementById("opcion_4").value.trim();
            
            if (!opcion1 || !opcion2 || !opcion3 || !opcion4) {
                alert("Debe completar las 4 opciones para una pregunta de selección múltiple.");
                return false;  // Prevenir el envío del formulario
            }
        }
        return true;  // Permitir el envío del formulario para otros tipos de preguntas
    }
</script>
{% endblock encuesta %}
