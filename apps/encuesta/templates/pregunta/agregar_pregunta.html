{% extends "encuestaHome.html" %}
{% block title %}
Agregar Pregunta
{% endblock title %}
{% load static %}

{% block navegacion %}
<div id="ruta_navegacion">
    <em>App/ modulo encuestas/ detalle encuesta/ agregar pregunta</em>
</div>
{% endblock navegacion %}

{% block encuesta %}
{% block modulo_encuestas %}
<div id="contenedor_modulo_encuestas">
    <h5>Modulo encuestas</h5>
    <p>A continuación podra agregar algun tipo de pregunta.</p>
    <a id="volver_incio_encuestas" href="{% url 'encuesta:inicio_encuestas' %}"><i class="fa-solid fa-house"></i></a>
</div>
    {% endblock modulo_encuestas %}
<div id="section_detalle_encuesta">
    <h5>Agregar pregunta</h5>
    <form method="POST" id="tipo-pregunta-form" onsubmit="return validateForm();">
        {% csrf_token %}
        {{ form.as_p }}
        
        <!-- Contenedor para las opciones múltiples -->
        <div id="opciones-container" style="display: none;">
            <h5>Agregar Opciones</h5>
            <div class="form-group">
                <label for="opcion_1">Opción 1</label>
                <input type="text" class="form-control" id="opcion_1" name="opcion_1">
            </div>
            <div class="form-group">
                <label for="opcion_2">Opción 2</label>
                <input type="text" class="form-control" id="opcion_2" name="opcion_2">
            </div>
            <div class="form-group">
                <label for="opcion_3">Opción 3</label>
                <input type="text" class="form-control" id="opcion_3" name="opcion_3">
            </div>
            <div class="form-group">
                <label for="opcion_4">Opción 4</label>
                <input type="text" class="form-control" id="opcion_4" name="opcion_4">
            </div>
        </div>

        <button class="btn btn-primary" type="submit">Agregar</button>
        <a class="btn btn-dark bg-gradient" href="{% url 'encuesta:inicio_encuestas' %}">Cancelar</a>
    </form>
    <hr>
    
</div>

<script>
    // Mostrar el contenedor de opciones si se selecciona "Selección múltiple"
    document.getElementById("id_tipoPregunta").addEventListener("change", function() {
        if (this.value === "4") {  // Ajusta según el valor de "Selección múltiple"
            document.getElementById("opciones-container").style.display = "block";
        } else {
            document.getElementById("opciones-container").style.display = "none";
        }
    });

    // Validar que las opciones no estén vacías antes de enviar el formulario
    function notificacionOpciones(mensaje){
        Swal.fire({
            title:'Debe ingresar todas las opiones',
            text: mensaje,
            icon: 'warning'
        })
    }

    function validateForm() {
        const tipoPregunta = document.getElementById("id_tipoPregunta").value;
        if (tipoPregunta === "4") {  // Ajusta según tu choice para selección múltiple
            const opcion1 = document.getElementById("opcion_1").value.trim();
            const opcion2 = document.getElementById("opcion_2").value.trim();
            const opcion3 = document.getElementById("opcion_3").value.trim();
            const opcion4 = document.getElementById("opcion_4").value.trim();
            
            if (!opcion1 || !opcion2 || !opcion3 || !opcion4) {
                notificacionOpciones();
                return false;  // Prevenir el envío del formulario
            }
        }
        return true;  // Permitir el envío del formulario para otros tipos de preguntas
    }
</script>
{% endblock encuesta %}
